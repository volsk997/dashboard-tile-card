type: custom:vertical-stack-in-card
cards:
  - type: custom:mushroom-template-card
    primary: |-
      {% set title = state_attr(config.entity,'media_title') %}

      {% if is_state(config.entity, 'playing') %} 
        {% if state_attr(config.entity,'media_title') is none or  state_attr(config.entity,'media_title') == ''%} Недоступно
        {% else%} {{title}} {% endif %}
      {% else %} Станция Мини
      {% endif %}
    secondary:  
    icon: yandex:station-mini-2
    entity: media_player.yandex_station_m00en2100jayck
    picture: ""
    badge_icon: ""
    badge_color: ""
    icon_color: 120,120,120
    tap_action:
      action: none
    double_tap_action:
      action: none
    fill_container: true
    layout: horizontal
    hold_action:
      action: none
    card_mod:
      style:
        mushroom-shape-icon$: |-
          {% set shape_variable = 'shape-color' %}
          {% include 'mushroom_icon_shape.jinja' %}

          {% set minimum = 0 %}
          {% set maximum = state_attr(config.entity, 'media_duration')|int(0) %}
          {% set x = state_attr(config.entity, 'media_position')|int(0) %}
          {% set station = 'mini2' %}
          {% set station_color = 'black' %}
          {% import 'yandex_colors.jinja' as colors %}
          {% if is_state(config.entity, 'playing') %}
            {% set color = colors.get_color(station, station_color) %}  {# Полный цвет #}
          {% else %}
            {% set color = colors.get_color(station, station_color) + ',0.5' %}  {# Полупрозрачный #}
          {% endif %}
          {% include 'mushroom_icon_shape_after.jinja' %}
        mushroom-state-info$: |
          .container {
           --card-secondary-color: {{states('input_text.tsvet_shrifta_vtorostepennaia_informatsiia')}};
           padding-right: 25px;
        .: |
          {% include 'mushroom_ha_card_transparent.jinja' %}
  - type: custom:mushroom-chips-card
    chips:
      - type: template
        icon: ""
        entity: media_player.yandex_station_m00en2100jayck
        tap_action:
          action: none
        hold_action:
          action: none
        double_tap_action:
          action: none
        picture: "{{state_attr(config.entity, 'entity_picture_local')}}"
    alignment: end
    card_mod:
      style: |
        {% include 'fixed_entity_picture.jinja' %}
  - type: custom:mushroom-chips-card
    chips:
      - type: conditional
        conditions:
          - condition: state
            entity: media_player.yandex_station_m00en2100jayck
            state: playing
        chip:
          type: template
          tap_action:
            action: perform-action
            perform_action: media_player.play_media
            target:
              entity_id: media_player.yandex_station_m00en2100jayck
            data:
              media_content_type: command
              media_content_id: лайк
          hold_action:
            action: none
          double_tap_action:
            action: none
          icon: mdi:heart
      - type: template
        icon_color: ""
        icon: >-
          {% if state_attr('media_player.yandex_station_m00en2100jayck',
          'media_duration')|int(0) > 0 %}

          fas:backward-step

          {% else %}

          {% endif %}
        tap_action:
          action: perform-action
          perform_action: media_player.media_previous_track
          target:
            entity_id:
              - media_player.yandex_station_m00en2100jayck
        hold_action:
          action: none
        double_tap_action:
          action: none
      - type: template
        icon_color: ""
        icon: |-
          {% if is_state(config.entity, 'paused')%}fas:play
          {% elif is_state(config.entity, 'playing')%}fas:pause
          {% else %} fas:lock
          {% endif %}
        tap_action:
          action: perform-action
          perform_action: script.turn_on
          target:
            entity_id: script.yandex_station_play_pause_extended
          data:
            variables:
              entity: media_player.yandex_station_m00en2100jayck
        hold_action:
          action: none
        double_tap_action:
          action: none
        entity: media_player.yandex_station_m00en2100jayck
      - type: template
        icon_color: ""
        icon: >-
          {% if state_attr('media_player.yandex_station_m00en2100jayck',
          'media_duration')|int(0) > 0 %}

          fas:forward-step

          {% else %}

          {% endif %}
        tap_action:
          action: perform-action
          perform_action: media_player.media_next_track
          target:
            entity_id: media_player.yandex_station_m00en2100jayck
        hold_action:
          action: none
        double_tap_action:
          action: none
      - type: conditional
        conditions:
          - condition: state
            entity: media_player.yandex_station_m00en2100jayck
            state: playing
        chip:
          type: template
          tap_action:
            action: perform-action
            perform_action: media_player.play_media
            target:
              entity_id: media_player.yandex_station_m00en2100jayck
            data:
              media_content_type: command
              media_content_id: дизлайк
          hold_action:
            action: none
          double_tap_action:
            action: none
          icon: mdi:heart-broken
    alignment: justify
    card_mod:
      style: |
        {% set top = 8 %} 
        {% set font_weight = 400 %}
        {% set font_size = 14 %}
        {% set chip_height = 45 %}
        {% include 'chip_secondary_shape.jinja' %}
  - type: custom:mushroom-chips-card
    chips:
      - type: template
        tap_action:
          action: none
        hold_action:
          action: none
        double_tap_action:
          action: none
        entity: media_player.yandex_station_m00en2100jayck
        icon: |-
          {% if is_state(config.entity, 'unavailable') %} mdi:alert-circle
          {% else %} 
            {% if is_state_attr(config.entity, 'alice_state', 'LISTENING') %} mdi:ear-hearing 
            {% elif is_state_attr(config.entity, 'source', 'SamsungTV') %} mdi:television
            {% elif is_state_attr(config.entity, 'alice_state', 'SPEAKING') %} mdi:account-voice
            {% elif is_state(config.entity, 'playing') %} mdi:speaker-wireless
            {% else %} mdi:sleep
            {% endif %}
          {% endif %}
        content: |-
          {% set player = config.entity %}
          {% include 'time_position_yandex.jinja' %}
        icon_color: >-
          {% if states(config.entity) in ['unknown', 'unavailable', 'none']  %}
          red

          {% else %} 

          {% endif %}
      - type: conditional
        conditions:
          - condition: state
            entity: binary_sensor.multirum_sostoianie
            state: "on"
          - condition: state
            entity: media_player.yandex_station_m00en2100jayck
            state: playing
        chip:
          type: template
          icon: ""
          content: • Везде
          tap_action:
            action: navigate
            navigation_path: /dashboard-iphone/multiroom
          hold_action:
            action: none
          double_tap_action:
            action: none
          card_mod:
            style: |
              ha-card {
                margin-left: -10px; ;
    alignment: start
    card_mod:
      style: |
        {% include 'scroll_secondary_ha_card_chip_container.jinja' %}
            position: absolute;
            top: 54px;
            left: 45px;
           }
  - type: custom:mushroom-chips-card
    chips:
      - type: template
        icon: >-
          {% if states(config.entity) in ['unknown', 'unavailable', 'none']  %}
          mdi:alert-circle

          {% else %} mdi:chevron-right

          {% endif %}
        icon_color: >-
          {% if states(config.entity) in ['unknown', 'unavailable', 'none']  %}
          red

          {% else %} 

          {% endif %}
        tap_action:
          action: navigate
          navigation_path: /dashboard-iphone/mini
        hold_action:
          action: none
        double_tap_action:
          action: none
        entity: media_player.yandex_station_m00en2100jayck
    alignment: end
    card_mod:
      style: |
        {% include 'thirdary_chip_ha_card.jinja' %}
grid_options:
  columns: 6
  rows: auto
card_mod:
  style: |
    {% set entity = 'media_player.yandex_station_m00en2100jayck' %}
    {% set state_on = 'playing' %}
    {% set hover = true %}

    {% include 'stack_card.jinja'%}
